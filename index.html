
<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Dropdown com Google Sheets API</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    h1 { color: darkgreen; }
    select { margin: 10px; padding: 5px; }
    #log { margin-top: 20px; color: red; white-space: pre-wrap; }
  </style>
</head>
<body>

  <h1>Galeria de Bonsais</h1>

  <label>Categoria:
    <select id="categoriaSelect">
      <option value="">A carregar...</option>
    </select>
  </label>

  <div id="log">Logs:</div>

  <script>
    const categoriaSelect = document.getElementById("categoriaSelect");

    function log(msg) {
      const el = document.getElementById("log");
      el.textContent += "\n" + msg;
      console.log(msg);
    }

    async function carregarCategorias() {
      const url = "https://sheets.googleapis.com/v4/spreadsheets/1VszHZn6YCPHGMhNzetQMpozbxxqK6KC1U9SNb_BzK7I/values/Categoria!A1:A100?key=AIzaSyAwYMSAn6yrut3thb5c0hrHONWnLTI1OWM";
      try {
        log("A carregar categorias via API...");
        const response = await fetch(url);
        if (!response.ok) throw new Error("HTTP " + response.status);
        const data = await response.json();
        const values = data.values;
        if (!values || values.length === 0) throw new Error("Nenhum dado encontrado.");

        categoriaSelect.innerHTML = '<option value="">Selecionar categoria</option>';
        values.forEach(([categoria]) => {
          const opt = document.createElement("option");
          opt.value = categoria;
          opt.textContent = categoria;
          categoriaSelect.appendChild(opt);
        });
        log("Categorias carregadas com sucesso.");
      } catch (err) {
        log("Erro ao carregar categorias: " + err.message);
      }
    }

    document.addEventListener("DOMContentLoaded", carregarCategorias);
  </script>

</body>
</html>
